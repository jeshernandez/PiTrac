<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <link rel="stylesheet" href="/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet"> <style id="jtd-nav-activation"> .site-nav > ul.nav-list:first-child > li > a, .site-nav > ul.nav-list:first-child > li > ul > li > a, .site-nav > ul.nav-list:first-child > li > ul > li > ul > li > a, .site-nav > ul.nav-list:first-child > li > ul > li > ul > li > ul > li:not(:nth-child(1)) > a, .site-nav > ul.nav-list:first-child > li > ul > li > ul > li > ul > li > ul > li a { background-image: none; } .site-nav > ul.nav-list:not(:first-child) a, .site-nav li.external a { background-image: none; } .site-nav > ul.nav-list:first-child > li:nth-child(2) > ul > li:nth-child(1) > ul > li:nth-child(2) > ul > li:nth-child(1) > a { font-weight: 600; text-decoration: none; }.site-nav > ul.nav-list:first-child > li:nth-child(2) > button svg, .site-nav > ul.nav-list:first-child > li:nth-child(2) > ul > li:nth-child(1) > button svg, .site-nav > ul.nav-list:first-child > li:nth-child(2) > ul > li:nth-child(1) > ul > li:nth-child(2) > button svg, .site-nav > ul.nav-list:first-child > li:nth-child(2) > ul > li:nth-child(1) > ul > li:nth-child(2) > ul > li:nth-child(1) > button svg { transform: rotate(-90deg); }.site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(2) > ul.nav-list, .site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(2) > ul.nav-list > li.nav-list-item:nth-child(1) > ul.nav-list, .site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(2) > ul.nav-list > li.nav-list-item:nth-child(1) > ul.nav-list > li.nav-list-item:nth-child(2) > ul.nav-list, .site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(2) > ul.nav-list > li.nav-list-item:nth-child(1) > ul.nav-list > li.nav-list-item:nth-child(2) > ul.nav-list > li.nav-list-item:nth-child(1) > ul.nav-list { display: block; } </style> <script src="/assets/js/vendor/lunr.min.js"></script> <script src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <link rel="icon" href="/assets/images/favicon.ico" type="image/x-icon"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Determine the cameras focal length | PiTrac</title> <meta name="generator" content="Jekyll v4.4.1" /> <meta property="og:title" content="Determine the cameras focal length" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Documentation for PiTrac" /> <meta property="og:description" content="Documentation for PiTrac" /> <link rel="canonical" href="http://localhost:4000/camera/camera_calibration_tee_camera_focal.html" /> <meta property="og:url" content="http://localhost:4000/camera/camera_calibration_tee_camera_focal.html" /> <meta property="og:site_name" content="PiTrac" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Determine the cameras focal length" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"Documentation for PiTrac","headline":"Determine the cameras focal length","url":"http://localhost:4000/camera/camera_calibration_tee_camera_focal.html"}</script> <!-- End Jekyll SEO tag --> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md --> <symbol id="svg-copy" viewBox="0 0 16 16"> <title>Copy</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/> <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"> <title>Copied</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"> <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header" role="banner"> <a href="/" class="site-title lh-tight"> PiTrac </a> <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false"> <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg> </button> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Home category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/" class="nav-list-link">Home</a><ul class="nav-list"><li class="nav-list-item"><a href="/thisdoc.html" class="nav-list-link">About this Document</a></li><li class="nav-list-item"><a href="/terminology.html" class="nav-list-link">Terminology</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Cameras category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/camera/cameras.html" class="nav-list-link">Cameras</a><ul class="nav-list"><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Calibration category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/camera/camera_calibration.html" class="nav-list-link">Calibration</a><ul class="nav-list"><li class="nav-list-item"><a href="/camera/camera_calibration_initial_setup.html" class="nav-list-link">Initial Setup</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Tee Camera (top) category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/camera/camera_calibration_tee_camera.html" class="nav-list-link">Tee Camera (top)</a><ul class="nav-list"><li class="nav-list-item"><a href="/camera/camera_calibration_tee_camera_focal.html" class="nav-list-link">Determine the cameras focal length</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Flight Camera (bottom) category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/camera/camera_calibration_flight_camera.html" class="nav-list-link">Flight Camera (bottom)</a><ul class="nav-list"><li class="nav-list-item"><a href="/camera/camera_calibration_flight_camera_CCFL.html" class="nav-list-link">Calibrate Focal Point Length</a></li><li class="nav-list-item"><a href="/camera/camera_calibration_flight_camera_calibration.html" class="nav-list-link">Camera Calibration Confirmation</a></li></ul></li><li class="nav-list-item"><a href="/camera/camera_calibration_undistortion_process.html" class="nav-list-link">Camera Lens Undistortion Process</a></li></ul></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in 3D Print category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/3dprint/3dprint.html" class="nav-list-link">3D Print</a><ul class="nav-list"><li class="nav-list-item"><a href="/3dprint/3dprint_base_layer_piside_floor.html" class="nav-list-link">3d Print Base Layer Pi Side Floor</a></li></ul></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search" role="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search PiTrac" aria-label="Search PiTrac" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="https://github.com/jamespilgrim/PiTrac/tree/main/docs" class="site-button" > Edit Me </a> </li> </ul> </nav> </div> <div class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="/camera/cameras.html">Cameras</a></li> <li class="breadcrumb-nav-list-item"><a href="/camera/camera_calibration.html">Calibration</a></li> <li class="breadcrumb-nav-list-item"><a href="/camera/camera_calibration_tee_camera.html">Tee Camera (top)</a></li> <li class="breadcrumb-nav-list-item"><span>Determine the cameras focal length</span></li> </ol> </nav> <div id="main-content" class="main-content"> <main> <h2 id="determine-the-cameras-focal-length"> <a href="#determine-the-cameras-focal-length" class="anchor-heading" aria-labelledby="determine-the-cameras-focal-length"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Determine the camera’s focal length </h2> <ol> <li>Place a ball on or at the marker. <ol> <li>For Tee camera, the ball will be immediately above the marker.</li> <li>For Flight camera, create a support that will hold the ball so that its center in space is where the marker point existed in space before it was replaced by an actual ball. Put the</li> <li>Example setups: Flight camera:</li> <li><img src="../assets/images/camera/image9.jpg" alt="" /></li> <li>Tee camera:</li> <li><img src="../assets/images/camera/image10.png" alt="" /></li> </ol> </li> <li>Ensure that the area around the ball has good contrast. For example, put down some black felt around the ball or use a white ball on a green hitting mat.</li> <li>For Tee camera, turn the LED strip on the LM base on to make sure there’s sufficient light for good exposures.</li> <li>Re-Measure H to ensure it’s correct - it is the distance on a line straight out from the camera lens to the ball center (at or near where the marker point was)</li> <li>Set the H distance into the appropriate parameter in the “calibration” section of the <code class="language-plaintext highlighter-rouge">golf_sim_config.json</code> file: <ol> <li>For Tee camera, <code class="language-plaintext highlighter-rouge">"kCamera1CalibrationDistanceToBall"</code>. <code class="language-plaintext highlighter-rouge">~87cm</code> is typical</li> <li>For Flight camera, <code class="language-plaintext highlighter-rouge">"kCamera2CalibrationDistanceToBall"</code>. <code class="language-plaintext highlighter-rouge">~55cm</code> is typical</li> </ol> </li> <li>For Flight camera, install the light filter and holder on the lens.</li> <li>Focus the lens as well as possible and lock in the focus by tightening the thumb screw closest to the camera (the other screw should already have been tightened). Using the brand-marking or number printed on the ball can help this process. This will establish the focal distance in the next step.</li> <li>IF NOT ALREADY DONE AT LEAST ONCE, PERFORM CAMERA LENS UNDISTORTION PROCESS (other section)</li> <li>Ensure the ball is well-lit, especially near its bottom. <ol> <li>For Flight camera, getting as much sunlight in as possible can help provide sufficient IR to see well, or an incandescent light can also help.</li> </ol> </li> <li>Run the <code class="language-plaintext highlighter-rouge">“runCam1Calibration.sh”</code> or <code class="language-plaintext highlighter-rouge">“runCam2Calibration.sh”</code> script to get the focal length. <ol> <li>It will take multiple measurements and average them. This will take a minute or so.</li> </ol> </li> <li>Set the resulting focal length into the .JSON file. <ol> <li>E.g., <code class="language-plaintext highlighter-rouge">"kCamera1FocalLength": 5.216</code> would be typical</li> </ol> </li> <li>Determine the x &amp; y (pan and tilt) camera1 angles for the configuration .JSON file</li> <li>[See <a href="https://docs.google.com/spreadsheets/d/1igc2V7oq-hGpFP5AKGjyzc2osLVpYHp969iPyHGttJ8/edit#gid=423758471">https://docs.google.com/spreadsheets/d/1igc2V7oq-hGpFP5AKGjyzc2osLVpYHp969iPyHGttJ8/edit#gid=423758471</a> for automatic calculations]</li> <li>X/pan is positive as the camera twists to face back to where the ball is teed (as the camera goes counter-clockwise viewed from above the LM).</li> <li>Y/tilt is negative as the camera starts to face down.</li> <li>The angles are measured from the bore of the camera if it were facing straight out at no angle and level with the ground</li> <li>XDeg = 90 - atan(Z/X) YDeg = -(90 - asin(R/H)) OR, for camera2, YDeg = ATan(Y/R), e.g, atan(4.5/40) = 6.42. <ol> <li>For example, for Tee camera: <ol> <li><code class="language-plaintext highlighter-rouge">XDeg = 56.31 , YDeg = -24.46</code></li> </ol> </li> <li>For example, for Flight camera: <ol> <li><code class="language-plaintext highlighter-rouge">X = -0.03 Y = 0.13 Z = 0.40 H = 0.42 R =</code></li> </ol> </li> </ol> </li> <li>Set the values in the configuration .JSON file: <ol> <li>(in “cameras” section) <code class="language-plaintext highlighter-rouge">"kCamera1Angles": [ 54.7, -22.2 ]</code>, (x,y or pan, tilt)</li> </ol> </li> <li>Place a ball ball near the mark on the tee-up spot so that there is a straight line from the camera to the mark that runs through the center of the ball (thus the ball will be slightly in front of the marker)</li> <li>Measure the distances to the center of the ball</li> <li>In the JSON file, set calibration.kCamera1CalibrationDistanceToBall to the distance to the ball in meters, e.g,. 0.81</li> <li>Run <code class="language-plaintext highlighter-rouge">“runCam1BallLocation.sh”</code> script to make sure the angles and distances and processing are correct</li> <li>The ball-search location should work in the center: <code class="language-plaintext highlighter-rouge">--search_center_x 723 --search_center_y 544</code>. If the script doesn’t return values, check the <code class="language-plaintext highlighter-rouge">log_view_final_search_image_for_Hough.png</code> file.</li> <li>Remember, that the distances will be approximately to the center of the ball FROM THE CAMERA, so will be a little shorter than the distance to the LM in the X direction.</li> </ol><hr /> </main> <hr> <footer> <p><a href="#top" id="back-to-top">Back to top</a></p> <p class="text-small text-grey-dk-100 mb-0">Copyright &copy; 2017-2020 Patrick Marsceill. Distributed by an <a href="https://github.com/just-the-docs/just-the-docs/tree/main/LICENSE.txt">MIT license.</a> <a href="https://www.netlify.com/">This site is powered by Netlify.</a></p> <div class="d-flex mt-2"> </div> </footer> </div> </div> <div class="search-overlay"></div> </div> <script src="https://cdn.jsdelivr.net/npm/mermaid@9.1.6/dist/mermaid.min.js"></script> <script> var config = {} ; mermaid.initialize(config); window.mermaid.init(undefined, document.querySelectorAll('.language-mermaid')); </script> </body> </html>
